@{
  Layout = "_Layout";
}

@model Factory.Models.Machine;
@using Factory.Models;

<h2>Machine Details</h2>
<hr />
<h3>@Html.DisplayFor(model => model.Model)</h3>
<div class="row">

  <div class="col-5 mch-info-col">
    <div class="row justify-content-center" id="mch-info-container">
      <div class="eng-status m-3">
        <p><strong class="mr-1">@Html.DisplayNameFor(model => model.OperationalStatus):</strong> @Html.DisplayFor(model => model.OperationalStatus)</p>
      </div>
      <div class="eng-hire-date m-3">
        <p><strong class="mr-1">@Html.DisplayNameFor(model => model.LastServiced):</strong> @Html.DisplayFor(model => model.LastServiced)</p>
      </div>
    </div>
  </div>

  <div class="col-7" id="associated-eng-col">
    @if (Model.JoinEntities.Count() == 0)
    {
      <h5 class="text-center">No engineers have been assigned to @Html.DisplayFor(model => model.Model) yet.</h5>
      <p>To assign an engineer click the button below.</p>
    }
    else
    {
      <table id="machine-table" class="table table-striped">
        <thead class="thead-light">
          <tr>
            <th scope="col">#</th>
            <th scope="col">Model</th>
            <th scope="col">Operational Status</th>
          </tr>
        </thead>
        <tbody>
        @foreach(Engineer engineer in Model.JoinEntities)
        {
          <tr>
            <td scope="row">@(i+1)</td>
            <td>@Html.ActionLink($"{@Model.ElementAt(i).Model}", "Details", "Clients", new {id = @Model.ElementAt(i).MachineId})</td>
            <td>@Model.ElementAt(i).OperationalStatus</td>
            
          </tr>
        }
    </tbody> 
  </table>
    }
  </div>
</div>

<hr />

@Html.ActionLink("View Engineers", "Index", new {}, new { @class = "btn btn-outline-primary" })
@Html.ActionLink("Edit", "Edit", new { id = Model.EngineerId }, new { @class = "btn btn-outline-primary" })
@Html.ActionLink("Delete", "Delete", new { id = Model.EngineerId }, new { @class = "btn btn-outline-primary" })